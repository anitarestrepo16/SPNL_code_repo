library(tidyverse)
library(readxl)
vars_to_keep = c("RSA", "RMSSD")
# save current directory
files_dir <- paste0(getwd(), '/Mindware Compilers/HRV_data/')
# obtain the HRV excel file names from the "HRV_data" folder
files = list(list.files(files_dir))
for(file in files){
id = str_replace(file, ".xlsx", "")
df = read_excel(paste0(files_dir, file)) %>%
filter(`Segment Number` %in% vars_to_keep)
df2 = as_tibble(t(df))[2:nrow(df2), ]
names(df2) = vars_to_keep
df2$Segment = c(seq(1, nrow(df2)))
df2$id = id
}
# save current directory
files_dir <- paste0(getwd(), '/HRV_data/')
# obtain the HRV excel file names from the "HRV_data" folder
files = list(list.files(files_dir))
for(file in files){
id = str_replace(file, ".xlsx", "")
df = read_excel(paste0(files_dir, file)) %>%
filter(`Segment Number` %in% vars_to_keep)
df2 = as_tibble(t(df))[2:nrow(df2), ]
names(df2) = vars_to_keep
df2$Segment = c(seq(1, nrow(df2)))
df2$id = id
}
View(df)
View(files)
View(files)
id = str_replace(files[1], ".xlsx", "")
df = read_excel(paste0(files_dir, files[1]))
View(df)
df = read_excel(paste0(files_dir, files[1])) %>%
filter(`Segment Number` %in% vars_to_keep)
View(df)
df2 = as_tibble(t(df))[2:nrow(df2), ]
df2 = as_tibble(t(df))[2:nrow(df), ]
View(df2)
View(df)
t(df)
shape(t(df))
nrow(t(df))
df2 = as_tibble(t(df))[2:(nrow(t(df)) - 1), ]
df2 = as_tibble(t(df))[2:(nrow(t(df))), ]
for(file in files){
id = str_replace(file, ".xlsx", "")
df = read_excel(paste0(files_dir, file)) %>%
filter(`Segment Number` %in% vars_to_keep)
df2 = as_tibble(t(df))[2:nrow(t(df)), ]
names(df2) = vars_to_keep
df2$Segment = c(seq(1, nrow(df2)))
df2$id = id
}
View(df2)
?tibble()
vars_to_keep
vars_to_keep + "blah"
c(vars_to_keep, "blah")
# extract data for each excel file
df_out <- tibble()
names(df_out) <- c(vars_to_keep, "Segment", "id")
# extract data for each excel file
df_out <- tibble(1:4)
View(df_out)
# extract data for each excel file
df_out <- tibble(matrix(ncol = 4))
names(df_out) <- c(vars_to_keep, "Segment", "id")
# extract data for each excel file
df_out <- tibble(matrix(ncol = 4, nrow = 0))
matrix(ncol = 4, nrow = 0)
# extract data for each excel file
df_out <- tibble(matrix(ncol = 4, nrow = 0))
names(df_out) <- c(vars_to_keep, "Segment", "id")
# extract data for each excel file
df_out <- tibble(matrix(ncol = 4, nrow = 0))
colnames(df_out) <- c(vars_to_keep, "Segment", "id")
View(df_out)
View(df_out)
# extract data for each excel file
df_out <- data.frame(matrix(ncol = 4, nrow = 0))
colnames(df_out) <- c(vars_to_keep, "Segment", "id")
View(df_out)
compile <- function(directory = get_wd(), vars_to_keep) {
# obtain the excel file names
files = list(list.files(files_dir))
# extract data for each excel file
df_out <- data.frame(matrix(ncol = 4, nrow = 0))
colnames(df_out) <- c(vars_to_keep, "Segment", "id")
for(file in files){
# save file name as id
id <- str_replace(file, ".xlsx", "")
# read in the file
df <- read_excel(paste0(directory, file)) %>%
# keep only relevant variables
filter(`Segment Number` %in% vars_to_keep)
# transpose the df
df2 <- as_tibble(t(df))[2:nrow(t(df)), ]
# change column names
names(df2) <- vars_to_keep
# add a column for segment number
df2$Segment <- c(seq(1, nrow(df2)))
# add id column
df2$id <- id
# append the subject data to the final df
df_out = rbind(df_out, df2)
}
return(df_out)
}
test <- compile(c("RSA", "RMSSD"))
test <- compile(vars_to_keep = c("RSA", "RMSSD"))
compile <- function(directory = getwd(), vars_to_keep) {
# obtain the excel file names
files = list(list.files(files_dir))
# extract data for each excel file
df_out <- data.frame(matrix(ncol = 4, nrow = 0))
colnames(df_out) <- c(vars_to_keep, "Segment", "id")
for(file in files){
# save file name as id
id <- str_replace(file, ".xlsx", "")
# read in the file
df <- read_excel(paste0(directory, file)) %>%
# keep only relevant variables
filter(`Segment Number` %in% vars_to_keep)
# transpose the df
df2 <- as_tibble(t(df))[2:nrow(t(df)), ]
# change column names
names(df2) <- vars_to_keep
# add a column for segment number
df2$Segment <- c(seq(1, nrow(df2)))
# add id column
df2$id <- id
# append the subject data to the final df
df_out = rbind(df_out, df2)
}
return(df_out)
}
test <- compile(vars_to_keep = c("RSA", "RMSSD"))
compile <- function(directory = paste0(getwd(), "/"), vars_to_keep) {
# obtain the excel file names
files = list(list.files(files_dir))
# extract data for each excel file
df_out <- data.frame(matrix(ncol = 4, nrow = 0))
colnames(df_out) <- c(vars_to_keep, "Segment", "id")
for(file in files){
# save file name as id
id <- str_replace(file, ".xlsx", "")
# read in the file
df <- read_excel(paste0(directory, file)) %>%
# keep only relevant variables
filter(`Segment Number` %in% vars_to_keep)
# transpose the df
df2 <- as_tibble(t(df))[2:nrow(t(df)), ]
# change column names
names(df2) <- vars_to_keep
# add a column for segment number
df2$Segment <- c(seq(1, nrow(df2)))
# add id column
df2$id <- id
# append the subject data to the final df
df_out = rbind(df_out, df2)
}
return(df_out)
}
test <- compile(vars_to_keep = c("RSA", "RMSSD"))
compile <- function(directory = paste0(getwd(), "/"), vars_to_keep) {
# obtain the excel file names
files = list(list.files(files_dir))
# extract data for each excel file
df_out <- data.frame(matrix(ncol = 4, nrow = 0))
colnames(df_out) <- c(vars_to_keep, "Segment", "id")
for(file in files){
# save file name as id
id <- str_replace(file, ".xlsx", "")
# read in the file
df <- read_excel(paste0(directory, file)) %>%
# keep only relevant variables
filter(`Segment Number` %in% vars_to_keep)
# transpose the df
df2 <- as_tibble(t(df))[2:nrow(t(df)), ]
# change column names
names(df2) <- vars_to_keep
# add a column for segment number
df2$Segment <- c(seq(1, nrow(df2)))
# add id column
df2$id <- id
# append the subject data to the final df
df_out = rbind(df_out, df2)
}
return(df_out)
}
test <- compile(vars_to_keep = c("RSA", "RMSSD"))
View(test)
source(HRV_compiler)
source("HRV_compiler")
source("HRV_compiler.R")
source("HRV_compiler.R")
full_data_df <- compile()
getwd()
getwd()
compile()
source("HRV_compiler.R")
source("HRV_compiler.R")
full_data_df <- compile()
source("HRV_compiler.R")
full_data_df <- compile()
?list.files
source("HRV_compiler.R")
full_data_df <- compile()
View(full_data_df)
full_data_df <- compile(directory = paste0(getwd(), "/HRV_data"), vars_to_keep = c("RSA", "RMSSD", "Mean IBI"))
source("HRV_compiler.R")
full_data_df <- compile(directory = paste0(getwd(), "/HRV_data"), vars_to_keep = c("RSA", "RMSSD", "Mean IBI"))
source("HRV_compiler.R")
full_data_df <- compile(directory = paste0(getwd(), "/HRV_data"), vars_to_keep = c("RSA", "RMSSD", "Mean IBI"))
View(full_data_df)
full_data_df <- compile(directory = paste0(getwd(), "/HRV_data"), vars_to_keep = c("RSA", "RMSSD", "Mean IBI"))
source("HRV_compiler.R")
full_data_df <- compile(directory = paste0(getwd(), "/HRV_data"), vars_to_keep = c("RSA", "RMSSD", "Mean IBI"))
View(full_data_df)
write_csv(full_data_df, "full_data_df.csv")
